# Borrowed from the s2n-bignum project
# https://github.com/awslabs/s2n-bignum/blob/main/arm/proofs/simulator.c
# Author(s): John Harrison, Juneyoung Lee

cd Arm/Insts/Cosim

OUTFILE=$(mktemp)

cat template.S | sed -e "s/ICODE/$1/" > ${OUTFILE}.S
gcc ${OUTFILE}.S simulator.c -o ${OUTFILE}.out
# gcc -o simulator simulator.c instance.o

shift 1
./{OUTFILE}.out $*

rm ${OUTFILE}.out ${OUTFILE}.S 

####  rm *.o simulator
